# Repository Manager Configuration
use_repository_manager: true  # Activé par défaut
repository_base_path: "/var/www/reports"
repository_retention_days: 30
webserver_type: "apache"  # nginx or apache

# New timestamped storage configuration
use_timestamped_directories: true
timestamp_format: "%Y%m%d%H%M%S"  # Format: YYYYMMDDhhmmss
max_archived_reports: 50  # Maximum number of timestamped directories to keep

# Repository initialization control
force_repository_setup: false  # Set to true to force re-initialization

# Alternative storage when repository is disabled
local_reports_path: "/tmp/ansible-reports"
local_reports_retention_hours: 24

# Execution configuration
updates_collection_serial: "50%"
send_notifications: true

# Report configuration
report_formats:
  - json
  - html
  - excel

# Enhanced web features
enable_search_functionality: true
enable_api_endpoints: true
enable_directory_browsing: true

# Notification configuration
notification_recipients:
  - email: "security@company.com"
    type: "security"
  - email: "ops@company.com"
    type: "operations"

# Security thresholds
security_thresholds:
  critical_updates: 5
  security_updates: 10
  total_updates: 50

# Web server performance settings
enable_compression: true
enable_caching: true
cache_duration_minutes: 60

# API configuration
enable_cors: true
api_cache_duration_minutes: 5

# SMTP configuration (use Ansible Vault for sensitive data)
# Note: Uncomment and configure these variables or use Ansible Vault
# smtp_server: "{{ vault_smtp_server | default('localhost') }}"
# smtp_port: "{{ vault_smtp_port | default(587) }}"
# smtp_username: "{{ vault_smtp_username | default('') }}"
# smtp_password: "{{ vault_smtp_password | default('') }}"
# smtp_use_tls: "{{ vault_smtp_use_tls | default(true) }}"
# smtp_from: "{{ vault_smtp_from | default('ansible-reports@company.com') }}"

# AWX Integration Settings
awx_integration_enabled: "{{ lookup('env', 'AWX_HOST') | length > 0 or lookup('env', 'TOWER_HOST') | length > 0 }}"
awx_artifacts_enabled: true
awx_fact_caching_enabled: true
awx_use_container_excel: true

# AWX-specific overrides (applied when running in AWX)
awx_overrides:
  use_repository_manager: false  # Disabled in AWX mode
  local_reports_path: "{{ lookup('env', 'AWX_ARTIFACTS_DIR') | default('/tmp/awx_artifacts') }}"
  disable_localhost_delegation: true
  use_set_stats: true

# Webhook configuration for notifications
# webhook_url: "{{ vault_webhook_url | default('') }}"
# webhook_token: "{{ vault_webhook_token | default('') }}"

# Container runtime for Excel generation in AWX
container_runtime_preference: "podman"  # podman or docker
container_image_excel: "python:3.9-slim"

# Dual-mode execution settings
maintain_backward_compatibility: true
enable_dual_mode_execution: true
auto_detect_execution_mode: true